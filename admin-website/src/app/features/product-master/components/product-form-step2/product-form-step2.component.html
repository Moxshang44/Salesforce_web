<form class="product-form-step2">
  <!-- Form Grid -->
  <div class="form-grid">
    <!-- Packaging Type -->
    <div class="form-group">
      <label class="form-label">
        Packaging Type
        <span class="required">*</span>
      </label>
      <select 
        class="form-select"
        [class.error]="errors['packaging_type']"
        [(ngModel)]="formData.packaging_type" 
        name="packaging_type"
        required
      >
        <option [ngValue]="null">Select Packaging Type</option>
        @for (type of packagingTypes; track type) {
          <option [value]="type">{{ type }}</option>
        }
      </select>
      @if (errors['packaging_type']) {
        <span class="error-message">{{ errors['packaging_type'] }}</span>
      }
    </div>

    <!-- Dimensions - Length -->
    <div class="form-group">
      <label class="form-label">Length <span class="optional">(Optional)</span></label>
      <div class="input-group">
        <input 
          type="number" 
          class="form-input" 
          [(ngModel)]="formData.dimensions.length" 
          name="dimensions.length"
          placeholder="0"
        />
        <select class="form-select-addon" [(ngModel)]="formData.dimensions.unit" name="dimensions.unit">
          @for (unit of dimensionUnits; track unit) {
            <option [value]="unit">{{ unit }}</option>
          }
        </select>
      </div>
    </div>

    <!-- Dimensions - Width -->
    <div class="form-group">
      <label class="form-label">Width <span class="optional">(Optional)</span></label>
      <input 
        type="number" 
        class="form-input" 
        [(ngModel)]="formData.dimensions.width" 
        name="dimensions.width"
        placeholder="0"
      />
    </div>

    <!-- Dimensions - Height -->
    <div class="form-group">
      <label class="form-label">Height <span class="optional">(Optional)</span></label>
      <input 
        type="number" 
        class="form-input" 
        [(ngModel)]="formData.dimensions.height" 
        name="dimensions.height"
        placeholder="0"
      />
    </div>

    <!-- Dimensions - Weight -->
    <div class="form-group">
      <label class="form-label">Weight <span class="optional">(Optional)</span></label>
      <input 
        type="number" 
        class="form-input" 
        [(ngModel)]="formData.dimensions.weight" 
        name="dimensions.weight"
        placeholder="0"
      />
    </div>

    <!-- Measurement Type -->
    <div class="form-group">
      <label class="form-label">Measurement Type <span class="optional">(Optional)</span></label>
      <select class="form-select" [(ngModel)]="formData.measurement_details.type" name="measurement_details.type">
        <option value="">Select Type</option>
        @for (type of measureTypes; track type) {
          <option [value]="type">{{ type }}</option>
        }
      </select>
    </div>

    <!-- Net Weight/Volume -->
    <div class="form-group">
      <label class="form-label">Net <span class="optional">(Optional)</span></label>
      <div class="input-group">
        <input 
          type="number" 
          class="form-input" 
          [(ngModel)]="formData.measurement_details.net" 
          name="measurement_details.net"
          placeholder="0"
        />
        <select class="form-select-addon" [(ngModel)]="formData.measurement_details.net_unit" name="measurement_details.net_unit">
          @for (unit of weightUnits; track unit) {
            <option [value]="unit">{{ unit }}</option>
          }
        </select>
      </div>
    </div>

    <!-- Gross Weight/Volume -->
    <div class="form-group">
      <label class="form-label">Gross <span class="optional">(Optional)</span></label>
      <div class="input-group">
        <input 
          type="number" 
          class="form-input" 
          [(ngModel)]="formData.measurement_details.gross" 
          name="measurement_details.gross"
          placeholder="0"
        />
        <select class="form-select-addon" [(ngModel)]="formData.measurement_details.gross_unit" name="measurement_details.gross_unit">
          @for (unit of weightUnits; track unit) {
            <option [value]="unit">{{ unit }}</option>
          }
        </select>
      </div>
    </div>

    <!-- Shelf Life -->
    <div class="form-group">
      <label class="form-label">Shelf Life <span class="optional">(Optional)</span></label>
      <div class="input-group">
        <input 
          type="text" 
          class="form-input" 
          [(ngModel)]="formData.measurement_details.shelf_life" 
          name="measurement_details.shelf_life"
          placeholder="Enter shelf life"
        />
      </div>
    </div>

    <!-- Compliance (Full Width) -->
    <div class="form-group full-width">
      <label class="form-label">Compliance <span class="optional">(Optional)</span></label>
      <textarea 
        class="form-textarea"
        [(ngModel)]="formData.compliance" 
        name="compliance"
        placeholder="Enter compliance information"
        rows="3"
      ></textarea>
    </div>
  </div>

  <!-- Packaging Details Section -->
  <div class="packaging-section">
    <div class="packaging-header">
      <h3 class="packaging-title">
        Packaging Details
        <span class="required">*</span>
      </h3>
      <button type="button" class="add-packaging-btn" (click)="addPackagingDetail()">
        + Add Packaging Detail
      </button>
    </div>
    @if (errors['packaging_details']) {
      <span class="error-message">{{ errors['packaging_details'] }}</span>
    }

    <div class="packaging-table-wrapper">
        <table class="packaging-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Quantity</th>
              <th>Parent</th>
              <th>Base Qty</th>
              <th>Base Unit</th>
              <th>Default</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            @for (detail of formData.packaging_details; track $index) {
              <tr>
                <td>
                  <input 
                    type="text" 
                    class="form-input-small"
                    [class.error]="errors['packaging_detail_' + $index + '_name']"
                    [(ngModel)]="detail.name" 
                    [name]="'packaging_name_' + $index"
                    placeholder="Name *"
                    required
                  />
                  @if (errors['packaging_detail_' + $index + '_name']) {
                    <span class="error-message">{{ errors['packaging_detail_' + $index + '_name'] }}</span>
                  }
                </td>
                <td>
                  <input 
                    type="number" 
                    class="form-input-small"
                    [class.error]="errors['packaging_detail_' + $index + '_qty']"
                    [(ngModel)]="detail.qty" 
                    [name]="'packaging_qty_' + $index"
                    placeholder="0 *"
                    min="0"
                    required
                  />
                  @if (errors['packaging_detail_' + $index + '_qty']) {
                    <span class="error-message">{{ errors['packaging_detail_' + $index + '_qty'] }}</span>
                  }
                </td>
                <td>
                  <input 
                    type="text" 
                    class="form-input-small" 
                    [(ngModel)]="detail.parent" 
                    [name]="'packaging_parent_' + $index"
                    placeholder="Parent (Optional)"
                  />
                </td>
                <td>
                  <input 
                    type="number" 
                    class="form-input-small"
                    [class.error]="errors['packaging_detail_' + $index + '_base_qty']"
                    [(ngModel)]="detail.base_qty" 
                    [name]="'packaging_base_qty_' + $index"
                    placeholder="0 *"
                    min="0"
                    required
                  />
                  @if (errors['packaging_detail_' + $index + '_base_qty']) {
                    <span class="error-message">{{ errors['packaging_detail_' + $index + '_base_qty'] }}</span>
                  }
                </td>
                <td>
                  <input 
                    type="text" 
                    class="form-input-small"
                    [class.error]="errors['packaging_detail_' + $index + '_base_unit']"
                    [(ngModel)]="detail.base_unit" 
                    [name]="'packaging_base_unit_' + $index"
                    placeholder="Unit *"
                    required
                  />
                  @if (errors['packaging_detail_' + $index + '_base_unit']) {
                    <span class="error-message">{{ errors['packaging_detail_' + $index + '_base_unit'] }}</span>
                  }
                </td>
                <td>
                  <input 
                    type="checkbox" 
                    class="checkbox" 
                    [(ngModel)]="detail.is_default"
                    [name]="'packaging_default_' + $index"
                  />
                </td>
                <td>
                  <button type="button" class="icon-btn delete" (click)="removePackagingDetail($index)" title="Delete">
                    üóëÔ∏è
                  </button>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
  </div>

  <!-- Form Actions -->
  <div class="form-actions">
    <app-button 
      variant="outline" 
      type="button"
      (click)="onPrevious()"
    >
      Previous
    </app-button>
    <app-button 
      variant="primary" 
      type="button"
      (click)="onSaveAndNext()"
    >
      Save & Next
    </app-button>
  </div>
</form>
