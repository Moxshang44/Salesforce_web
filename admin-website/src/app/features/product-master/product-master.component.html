<div class="product-master-layout">
  <app-sidebar></app-sidebar>

  <div class="main-content">
    <app-header></app-header>

    <div class="product-content">
      <!-- Page Header -->
      <div class="page-header">
        <h1 class="page-title">Products List</h1>
        
        <div class="header-actions">
          <app-button variant="primary" size="sm" (click)="onBulkUpload()">
            <img src="assets/images/bulkupload.png" alt="Bulk Upload" class="button-icon">
            Bulk Upload
          </app-button>
          <app-button variant="primary" size="sm" (click)="onExport()">
            <img src="assets/images/export.png" alt="Export" class="button-icon">
            Excel
          </app-button>
          <app-button variant="primary" size="sm" (click)="onAdd()">
            <img src="assets/images/add.png" alt="Add" class="button-icon">
            Add
          </app-button>
        </div>
      </div>

      <!-- Table Controls -->
      <div class="table-controls">
        <div class="pagination-controls">
          <button class="page-nav" (click)="previousPage()" [disabled]="currentPage === 1">
            <<
          </button>
          <button 
            class="page-number" 
            [class.active]="currentPage === 1"
            (click)="goToPage(1)"
          >
            1
          </button>
          <button 
            class="page-number"
            [class.active]="currentPage === 2"
            (click)="goToPage(2)"
          >
            2
          </button>
          <button class="page-nav" (click)="nextPage()" [disabled]="currentPage === totalPages">
            >>
          </button>
        </div>

        <div class="search-filter">
          <button class="filter-btn" (click)="onFilter()">
            <img src="assets/images/filter.png" alt="Filter" class="filter-icon-img">
            Filter
          </button>
          <div class="search-box">
            <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <input 
              type="text" 
              placeholder="Search..." 
              class="search-input"
              (input)="onSearch($event)"
            />
          </div>
        </div>
      </div>

      <!-- Table Card -->
      <div class="table-card">
        <!-- Data Table -->
        <div class="table-wrapper">
          <table class="product-table">
            <thead>
              <tr>
                <th class="col-action">Action</th>
                <th class="col-active">Active</th>
                <th class="col-brand">Brand/Type-Code</th>
                <th class="col-name">Name/size/Category</th>
              </tr>
            </thead>
            <tbody>
              @for (product of products; track product.id) {
                <tr>
                  <td class="col-action">
                    <div class="action-buttons">
                      <button class="action-btn edit" (click)="onEdit(product)" title="Edit">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                      <button class="action-btn view" (click)="onEdit(product)" title="View">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                      <button class="action-btn delete" (click)="onDelete(product)" title="Delete">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M3 6h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          <line x1="10" y1="11" x2="10" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          <line x1="14" y1="11" x2="14" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                    </div>
                  </td>
                  <td class="col-active">
                    <span 
                      class="status-badge" 
                      [class.active]="product.active"
                      [class.inactive]="!product.active"
                    >
                      {{ product.active ? 'Yes' : 'No' }}
                    </span>
                  </td>
                  <td class="col-brand">
                    <div class="brand-info">
                      <div class="brand-name">{{ product.brand }}</div>
                      <div class="type-code">{{ product.typeCode }}</div>
                    </div>
                  </td>
                  <td class="col-name">
                    <div class="product-info">
                      <div class="product-name">{{ product.name }}</div>
                      <div class="product-category">{{ product.category }}</div>
                    </div>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>

        <!-- Table Footer -->
        <div class="table-footer">
          <p>Showing 1 to 10 of 15 entries</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Product Modal -->
  <app-modal 
    [isOpen]="isAddModalOpen" 
    [title]="getModalTitle()"
    width="900px"
    (close)="closeAddModal()"
  >
    @if (currentStep === 1) {
      <app-product-form 
        (save)="onSaveStep1($event)"
        (cancel)="closeAddModal()"
      ></app-product-form>
    }
    @if (currentStep === 2) {
      <app-product-form-step2 
        (save)="onSaveStep2($event)"
        (previous)="onPreviousStep()"
      ></app-product-form-step2>
    }
    @if (currentStep === 3) {
      <app-product-form-step3 
        (save)="onSaveStep3($event)"
        (previous)="onPreviousStep()"
      ></app-product-form-step3>
    }
    @if (currentStep === 3.2) {
      <app-product-form-step3-2 
        (save)="onSaveStep3_2($event)"
        (previous)="onPreviousStep()"
      ></app-product-form-step3-2>
    }
    @if (currentStep === 4) {
      <app-product-form-step4 
        (save)="onSaveStep4($event)"
        (previous)="onPreviousStep()"
      ></app-product-form-step4>
    }
  </app-modal>
</div>

